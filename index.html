<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì˜ë‹¨ì–´ ë§ˆìŠ¤í„°</title>
  <style>
    body { font-family: sans-serif; margin: 20px; background: #f8f9fa; }
    h1 { color: #333; }
    input, button, select { padding: 8px; margin: 5px; }
    .word { border: 1px solid #ccc; padding: 10px; margin: 5px 0; background: #fff; }
    .test-area { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>ğŸŒŸ ì˜ë‹¨ì–´ ë‹¨ì–´ì¥</h1>  <input id="wordInput" placeholder="ë‹¨ì–´ ì…ë ¥" />
  <button onclick="addWord()">ì¶”ê°€</button>
  <button onclick="clearWords()">ë‹¨ì–´ì¥ ì´ˆê¸°í™”</button>  <div id="wordList"></div>  <div class="test-area">
    <h2>ğŸ§  í…ŒìŠ¤íŠ¸</h2>
    <label>ë¬¸ì œ ê°œìˆ˜: <input id="testCount" type="number" min="1" max="50" value="5" /></label>
    <select id="testFilter">
      <option value="all">ëª¨ë“  ë‹¨ì–´</option>
      <option value="wrong">í‹€ë¦° ë‹¨ì–´ë§Œ</option>
    </select>
    <button onclick="startTest()">í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
    <div id="testArea"></div>
  </div>  <script>
    let words = JSON.parse(localStorage.getItem("words") || "[]");

    async function translateKorean(text) {
      const res = await fetch("https://libretranslate.com/translate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ q: text, source: "en", target: "ko", format: "text" })
      });
      const data = await res.json();
      return data.translatedText;
    }

    async function fetchWordInfo(word) {
      const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
      const data = await res.json();
      const eng = data[0]?.meanings[0]?.definitions[0]?.definition || "";
      const smpl = data[0]?.meanings[0]?.definitions[0]?.example || "ì˜ˆë¬¸ ì—†ìŒ";
      const kor = await translateKorean(eng);
      return { meaning: kor, example: smpl };
    }

    async function addWord() {
      const word = document.getElementById("wordInput").value.trim();
      if (!word) return;
      const info = await fetchWordInfo(word);
      words.push({ word, ...info, correct: false });
      localStorage.setItem("words", JSON.stringify(words));
      document.getElementById("wordInput").value = "";
      renderWords();
    }

    function clearWords() {
      if (confirm("ì •ë§ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        words = [];
        localStorage.removeItem("words");
        renderWords();
        document.getElementById("testArea").innerHTML = "";
      }
    }

    function renderWords() {
      const list = document.getElementById("wordList");
      list.innerHTML = "<h2>ğŸ“š ë‹¨ì–´ ëª©ë¡</h2>" +
        words.map(w => `
          <div class="word">
            <strong>${w.word}</strong><br/>
            ëœ»: ${w.meaning}<br/>
            ì˜ˆë¬¸: ${w.example}<br/>
            í…ŒìŠ¤íŠ¸: ${w.correct ? "âœ… ì •ë‹µ" : "âŒ ì•„ì§ í‹€ë¦¼"}
          </div>
        `).join("");
    }

    function startTest() {
      const count = parseInt(document.getElementById("testCount").value) || 5;
      const filter = document.getElementById("testFilter").value;
      const targetWords = filter === "wrong" ? words.filter(w => !w.correct) : words;
      const sample = targetWords.sort(() => 0.5 - Math.random()).slice(0, count);

      const area = document.getElementById("testArea");
      area.innerHTML = "";
      sample.forEach((w, i) => {
        const id = `test_${i}`;
        area.innerHTML += `
          <div class="word">
            <strong>${w.word}</strong><br/>
            ëœ» ì…ë ¥: <input id="${id}" data-answer="${w.meaning}" /><br/>
            <button onclick="checkAnswer('${id}', '${w.word}')">í™•ì¸</button>
            <div id="${id}_result"></div>
          </div>
        `;
      });
    }

    function checkAnswer(id, wordText) {
      const input = document.getElementById(id);
      const answer = input.dataset.answer;
      const user = input.value.trim();
      const isCorrect = answer.includes(user);
      const result = document.getElementById(`${id}_result`);
      const word = words.find(w => w.word === wordText);
      if (word) word.correct = isCorrect;
      localStorage.setItem("words", JSON.stringify(words));
      result.innerHTML = isCorrect ?
        `âœ… ì •ë‹µì…ë‹ˆë‹¤!<br/>ëœ»: ${word.meaning}<br/>ì˜ˆë¬¸: ${word.example}` :
        `âŒ ì˜¤ë‹µì…ë‹ˆë‹¤.<br/>ì •ë‹µ: ${word.meaning}<br/>ì˜ˆë¬¸: ${word.example}`;
      renderWords();
    }

    renderWords();
  </script></body>
</html>
