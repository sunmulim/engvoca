<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="icon" href="icon.png" type="image/png">
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="manifest" href="manifest.json">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì˜ì–´ë‹¨ì–´ì¥</title>
  <style>
    /* ì „ì²´ì ì¸ ë¶„ìœ„ê¸° */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* ì¢€ ë” ì„¸ë ¨ëœ í°íŠ¸ */
      background-color: #F0F8FF; /* ì€ì€í•œ í•˜ëŠ˜ìƒ‰ ë°°ê²½ */
      color: #0D47A1; /* ì§„í•œ íŒŒë€ìƒ‰ ê¸€ì”¨ */
      padding: 20px;
      line-height: 1.6; /* ê°€ë…ì„± ê°œì„  */
    }

    h1 {
      color: #0277BD; /* ì‹œì›í•œ íŒŒë€ìƒ‰ ì œëª© */
      text-align: center;
      margin-bottom: 30px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1); /* ì€ì€í•œ ê·¸ë¦¼ì */
    }

    /* ì…ë ¥ í•„ë“œì™€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    input[type="text"], input[type="number"], button { /* ìˆ«ì ì…ë ¥ í•„ë“œ ì¶”ê°€ */
      margin: 8px; /* ê°„ê²© ì¢€ ë” ë„“ê²Œ */
      padding: 12px 15px; /* íŒ¨ë”© ëŠ˜ë ¤ì„œ í´ë¦­/ì…ë ¥ í¸í•˜ê²Œ */
      border-radius: 25px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
      border: none;
      font-size: 1rem;
      transition: all 0.3s ease; /* ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ */
      vertical-align: middle; /* ì„¸ë¡œ ì •ë ¬ */
    }

    input[type="text"], input[type="number"] { /* ìˆ«ì ì…ë ¥ í•„ë“œ ì¶”ê°€ */
      border: 1px solid #B3E5FC; /* ì—°í•œ í•˜ëŠ˜ìƒ‰ í…Œë‘ë¦¬ */
      background-color: #FFFFFF; /* í•˜ì–€ìƒ‰ ë°°ê²½ */
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1); /* ì€ì€í•œ ë‚´ë¶€ ê·¸ë¦¼ì */
      width: calc(50% - 20px); /* ë„ˆë¹„ ì¡°ì • */
      box-sizing: border-box; /* íŒ¨ë”©/ë³´ë” í¬í•¨ ë„ˆë¹„ ê³„ì‚° */
    }

    input[type="number"] {
        width: 80px; /* ë¬¸ì œ ìˆ˜ ì…ë ¥ í•„ë“œ ë„ˆë¹„ ì¡°ì • */
        text-align: center;
    }

    button {
      background-color: #4FC3F7; /* ë°ì€ íŒŒë€ìƒ‰ ë²„íŠ¼ */
      color: white;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2); /* ë²„íŠ¼ ê·¸ë¦¼ì */
    }

    button:hover {
      background-color: #0288D1; /* í˜¸ë²„ ì‹œ ì§„í•œ íŒŒë€ìƒ‰ */
      box-shadow: 0 4px 8px rgba(0,0,0,0.3); /* í˜¸ë²„ ì‹œ ê·¸ë¦¼ì ê°•í™” */
      transform: translateY(-2px); /* ì‚´ì§ ìœ„ë¡œ ëœ¨ëŠ” íš¨ê³¼ */
    }

    /* ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
    label {
        margin-left: 10px;
        font-size: 0.9rem;
        color: #0D47A1;
        vertical-align: middle; /* ì„¸ë¡œ ì •ë ¬ */
    }

    /* ë‹¨ì–´ ëª©ë¡ ìŠ¤íƒ€ì¼ */
    #wordList {
        margin-top: 30px;
        padding: 20px;
        background-color: #E1F5FE; /* ì—°í•œ í•˜ëŠ˜ìƒ‰ ë°°ê²½ */
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    #wordList h2 {
        color: #0277BD;
        margin-top: 0;
        border-bottom: 2px solid #B3E5FC; /* ì—°í•œ í•˜ëŠ˜ìƒ‰ ë°‘ì¤„ */
        padding-bottom: 10px;
        margin-bottom: 20px;
    }

    .word-item {
      margin-bottom: 15px; /* ê°„ê²© ëŠ˜ë¦¼ */
      padding: 15px; /* íŒ¨ë”© ëŠ˜ë¦¼ */
      background-color: #FFFFFF; /* í•˜ì–€ìƒ‰ ì•„ì´í…œ ë°°ê²½ */
      border-left: 5px solid #0288D1; /* ì§„í•œ íŒŒë€ìƒ‰ ì™¼ìª½ í…Œë‘ë¦¬ */
      border-radius: 8px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
      box-shadow: 0 1px 3px rgba(0,0,0,0.1); /* ì€ì€í•œ ê·¸ë¦¼ì */
      display: flex; /* ë‚´ìš© ì •ë ¬ */
      justify-content: space-between; /* ë‹¨ì–´/ëœ»ê³¼ ê²°ê³¼ ë¶„ë¦¬ */
      align-items: center;
    }

    .word-item strong {
        color: #0D47A1; /* ë‹¨ì–´ëŠ” ì§„í•œ íŒŒë€ìƒ‰ */
    }

    .correct {
      color: #388E3C; /* ì´ˆë¡ìƒ‰ (ì •ë‹µ) */
      font-weight: bold;
    }
    .incorrect {
      color: #D32F2F; /* ë¹¨ê°„ìƒ‰ (ì˜¤ë‹µ) */
      font-weight: bold;
    }

    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    #testModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.6); /* ì¢€ ë” ë¶€ë“œëŸ¬ìš´ ë°°ê²½ */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(5px); /* ë°°ê²½ ë¸”ëŸ¬ íš¨ê³¼ */
    }

    #testBox {
      background: #FFFFFF; /* í•˜ì–€ìƒ‰ ëª¨ë‹¬ ë°°ê²½ */
      padding: 40px; /* íŒ¨ë”© ëŠ˜ë¦¼ */
      border-radius: 15px; /* ë” ë‘¥ê·¼ ëª¨ì„œë¦¬ */
      width: 90%;
      max-width: 500px; /* ìµœëŒ€ ë„ˆë¹„ ì¡°ì • */
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3); /* ëª¨ë‹¬ ê·¸ë¦¼ì */
      animation: fadeIn 0.5s ease-out; /* ë‚˜íƒ€ë‚˜ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.9); }
        to { opacity: 1; transform: scale(1); }
    }

    #testBox h2 {
        color: #0277BD;
        margin-top: 0;
        margin-bottom: 20px;
    }

    #testBox p {
        font-size: 1.1rem;
        margin-bottom: 15px;
        color: #0D47A1;
    }

    #testBox input[type="text"] {
        width: calc(100% - 30px); /* ëª¨ë‹¬ ë‚´ ì…ë ¥ì°½ ë„ˆë¹„ */
        margin-bottom: 20px;
    }

    #testBox button {
        margin-top: 10px;
    }

    #testResult {
        margin-top: 20px;
        font-size: 1.1rem;
        font-weight: bold;
    }

    #timer {
        color: #D32F2F; /* íƒ€ì´ë¨¸ëŠ” ë¹¨ê°„ìƒ‰ */
        font-weight: bold;
    }

    /* ë°˜ì‘í˜• ë””ìì¸ ê³ ë ¤ (ê°„ë‹¨í•˜ê²Œ) */
    @media (max-width: 600px) {
        input[type="text"], input[type="number"] { /* ìˆ«ì ì…ë ¥ í•„ë“œ ì¶”ê°€ */
            width: calc(100% - 16px); /* ëª¨ë°”ì¼ì—ì„œ ë„ˆë¹„ ì¡°ì • */
            margin: 8px 0;
        }
         input[type="number"] {
            width: 100px; /* ëª¨ë°”ì¼ì—ì„œ ìˆ«ì ì…ë ¥ í•„ë“œ ë„ˆë¹„ */
         }
        button {
            width: 100%; /* ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ ë„ˆë¹„ 100% */
            margin: 8px 0;
        }
        label {
            display: block; /* ëª¨ë°”ì¼ì—ì„œ ì²´í¬ë°•ìŠ¤ ì•„ë˜ë¡œ */
            margin: 10px 0;
        }
        #testBox {
            padding: 20px;
        }
    }

  </style>
</head>
<body>
  <h1>ë‹¨ì–´ì¥</h1>
  <input type="text" id="wordInput" placeholder="ë‹¨ì–´" />
  <input type="text" id="meaningInput" placeholder="ëœ» (ì‰¼í‘œë¡œ êµ¬ë¶„)" />
  <button onclick="addWord()">ë‹¨ì–´ ì¶”ê°€</button>
  <button onclick="resetWords()">ì´ˆê¸°í™”</button>

  <br> <!-- ì¤„ë°”ê¿ˆí•´ì„œ ë ˆì´ì•„ì›ƒ ì •ë¦¬ -->

  <label for="numQuestionsInput">ë¬¸ì œ ìˆ˜:</label> <!-- ë¬¸ì œ ìˆ˜ ì…ë ¥ ë¼ë²¨ -->
  <input type="number" id="numQuestionsInput" value="10" min="1" /> <!-- ë¬¸ì œ ìˆ˜ ì…ë ¥ í•„ë“œ -->
  <button onclick="prepareTest()">í…ŒìŠ¤íŠ¸</button>
  <label><input type="checkbox" id="excludeCorrect" /> ë§ì€ ë¬¸ì œ ì œì™¸</label>
  <button onclick="toggleWordList()" id="toggleBtn">ë‹¨ì–´ì¥ ë³´ê¸°/ìˆ¨ê¸°ê¸°</button>

  <div id="wordList"></div>
  <div id="testSection"></div>
  <div id="testModal" style="display:none">
    <div id="testBox">
      <h2 id="questionTitle"></h2>
      <p><strong id="testWord"></strong></p>
      <p>ë‚¨ì€ ì‹œê°„âŒšï¸: <span id="timer">20</span>ì´ˆ</p>
      <button onclick="showHint()">íŒíŠ¸ğŸ”</button><br>
      <input type="text" id="testAnswer" placeholder="ëœ» ì…ë ¥" /><br>
      <button onclick="submitAnswer()">ì œì¶œğŸ’Œ</button>
      <div id="testResult"></div>
    </div>
  </div>
  <script>
    let words = JSON.parse(localStorage.getItem("words") || "[]");
    let currentTest = [], currentIndex = 0, testTimer, timeLeft = 20;

    function saveWords() {
      localStorage.setItem("words", JSON.stringify(words));
    }

    function addWord() {
      const word = document.getElementById("wordInput").value.trim();
      const meaning = document.getElementById("meaningInput").value.trim();
      if (word && meaning) {
        words.push({ word, meanings: meaning.split(',').map(m => m.trim()), correct: null });
        saveWords();
        displayWords();
        document.getElementById("wordInput").value = "";
        document.getElementById("meaningInput").value = "";
      }
    }

    function resetWords() {
      if (confirm("ì •ë§ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        words = [];
        saveWords();
        displayWords();
      }
    }

    function displayWords() {
      const list = document.getElementById("wordList");
      list.innerHTML = "<h2>ë‹¨ì–´ ëª©ë¡</h2>";
      words.forEach((item, index) => {
        const div = document.createElement("div");
        div.className = "word-item";
        div.innerHTML = `<strong>${item.word}</strong> - ${item.meanings.join(', ')} ` +
          (item.correct === true ? '<span class="correct">(ì •ë‹µ)</span>' : item.correct === false ? '<span class="incorrect">(ì˜¤ë‹µ)</span>' : "");
        list.appendChild(div);
      });
    }

    function toggleWordList() {
      const list = document.getElementById("wordList");
      const toggleBtn = document.getElementById("toggleBtn");
      if (list.style.display === "none" || list.innerHTML.includes("<h2>ë‹¨ì–´ ëª©ë¡</h2>") && list.children.length <= 1) { // ì´ˆê¸° ìƒíƒœ ë˜ëŠ” ìˆ¨ê¹€ ìƒíƒœ (ì œëª©ë§Œ ìˆëŠ” ê²½ìš° í¬í•¨)
          list.style.display = "block";
          toggleBtn.innerText = "ë‹¨ì–´ì¥ ìˆ¨ê¸°ê¸°";
      } else {
          list.style.display = "none";
          toggleBtn.innerText = "ë‹¨ì–´ì¥ ë³´ê¸°";
      }
    }


    function prepareTest() {
      const excludeCorrect = document.getElementById("excludeCorrect").checked;
      const filteredWords = words.filter(w => !excludeCorrect || w.correct !== true); // í•„í„°ë§ëœ ë‹¨ì–´ ëª©ë¡

      const numQuestionsInput = document.getElementById("numQuestionsInput");
      const numQuestions = parseInt(numQuestionsInput.value, 10); // ì…ë ¥ëœ ë¬¸ì œ ìˆ˜ ì •ìˆ˜ë¡œ ë³€í™˜

      // ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì‚¬
      if (isNaN(numQuestions) || numQuestions <= 0) {
          alert("ë¬¸ì œ ìˆ˜ëŠ” 1 ì´ìƒì˜ ìˆ«ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
          numQuestionsInput.value = 10; // ê¸°ë³¸ê°’ìœ¼ë¡œ ë˜ëŒë¦¼
          return;
      }

      if (filteredWords.length === 0) {
          alert("ì¶œì œí•  ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤. (ë§ì€ ë¬¸ì œ ì œì™¸ ì˜µì…˜ í™•ì¸)");
          return;
      }

      if (numQuestions > filteredWords.length) {
          alert(`ì…ë ¥ëœ ë¬¸ì œ ìˆ˜(${numQuestions}ê°œ)ê°€ ì¶œì œ ê°€ëŠ¥í•œ ë¬¸ì œ ìˆ˜(${filteredWords.length}ê°œ)ë³´ë‹¤ ë§ìŠµë‹ˆë‹¤. ì¶œì œ ê°€ëŠ¥í•œ ìµœëŒ€ ë¬¸ì œ ìˆ˜ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.`);
          currentTest = shuffle([...filteredWords]); // ê°€ëŠ¥í•œ ëª¨ë“  ë¬¸ì œë¡œ í…ŒìŠ¤íŠ¸
      } else {
          // í•„í„°ë§ëœ ëª©ë¡ì„ ì„ì–´ì„œ ì…ë ¥ëœ ìˆ˜ë§Œí¼ ìë¥´ê¸°
          currentTest = shuffle([...filteredWords]).slice(0, numQuestions);
      }


      currentIndex = 0;
      document.getElementById("wordList").style.display = "none"; // í…ŒìŠ¤íŠ¸ ì‹œì‘ ì‹œ ë‹¨ì–´ì¥ ìˆ¨ê¹€
      document.getElementById("testModal").style.display = "flex";
      showQuestion();
    }

    function showQuestion() {
      clearInterval(testTimer);
      timeLeft = 20;
      document.getElementById("timer").innerText = timeLeft;
      const current = currentTest[currentIndex];
      // ë¬¸ì œ ë²ˆí˜¸ í‘œì‹œ ì—…ë°ì´íŠ¸ (ì „ì²´ ë¬¸ì œ ìˆ˜ ë°˜ì˜)
      document.getElementById("questionTitle").innerText = `ë¬¸ì œ ${currentIndex + 1} / ${currentTest.length}`;
      document.getElementById("testWord").innerText = current.word;
      document.getElementById("testAnswer").value = "";
      document.getElementById("testResult").innerText = "";
      testTimer = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").innerText = timeLeft;
        if (timeLeft <= 0) submitAnswer();
      }, 1000);
    }

    function submitAnswer() {
      clearInterval(testTimer);
      const input = document.getElementById("testAnswer").value.trim();
      // ì…ë ¥ëœ ëœ»ì„ ì‰¼í‘œë¡œ ë¶„ë¦¬í•˜ì—¬ ë°°ì—´ë¡œ ë§Œë“¤ê³  ê³µë°± ì œê±°
      const inputMeanings = input.split(',').map(m => m.trim()).filter(m => m !== '');
      const correctMeanings = currentTest[currentIndex].meanings;

      // ì…ë ¥ëœ ëœ» ì¤‘ í•˜ë‚˜ë¼ë„ ì •ë‹µ ëœ» ëª©ë¡ì— í¬í•¨ë˜ë©´ ì •ë‹µìœ¼ë¡œ ì²˜ë¦¬
      const isCorrect = inputMeanings.some(im => correctMeanings.includes(im));


      const result = document.getElementById("testResult");
      result.innerHTML = isCorrect ? `<span class='correct'>ì •ë‹µ! (${correctMeanings.join(', ')})</span>` :
        `<span class='incorrect'>ì˜¤ë‹µ. ì •ë‹µ: ${correctMeanings.join(', ')}</span>`;

      // ì›ë³¸ words ë°°ì—´ì—ì„œ í•´ë‹¹ ë‹¨ì–´ë¥¼ ì°¾ì•„ì„œ correct ìƒíƒœ ì—…ë°ì´íŠ¸
      const original = words.find(w => w.word === currentTest[currentIndex].word);
      if (original) original.correct = isCorrect; // ì •ë‹µ ì—¬ë¶€ ì—…ë°ì´íŠ¸
      saveWords();

      setTimeout(() => {
        currentIndex++;
        if (currentIndex >= currentTest.length) {
          document.getElementById("testModal").style.display = "none";
          displayWords(); // í…ŒìŠ¤íŠ¸ ëë‚˜ë©´ ë‹¨ì–´ì¥ ë‹¤ì‹œ í‘œì‹œ
          document.getElementById("wordList").style.display = "block"; // ë‹¨ì–´ì¥ ë³´ì´ê²Œ ì„¤ì •
          document.getElementById("toggleBtn").innerText = "ë‹¨ì–´ì¥ ìˆ¨ê¸°ê¸°"; // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
        } else {
          showQuestion();
        }
      }, 2000); // 2ì´ˆ í›„ì— ë‹¤ìŒ ë¬¸ì œ ë˜ëŠ” ì¢…ë£Œ
    }

    function showHint() {
      const word = currentTest[currentIndex].meanings[0];
      if (!word) return alert("íŒíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤."); // ëœ»ì´ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬
      const hint = word[0] + ' -'.repeat(word.length > 1 ? word.length - 1 : 0); // ë‹¨ì–´ê°€ í•œ ê¸€ìë©´ '-' ì•ˆ ë¶™ì„
      alert(`íŒíŠ¸: ${hint}`);
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë‹¨ì–´ì¥ í‘œì‹œ ë° ë²„íŠ¼ í…ìŠ¤íŠ¸ ì„¤ì •
    displayWords();
    // ë‹¨ì–´ ëª©ë¡ì´ ë¹„ì–´ìˆì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ë³´ì´ê²Œ ì„¤ì •
    if (words.length > 0) {
        document.getElementById("wordList").style.display = "block";
        document.getElementById("toggleBtn").innerText = "ë‹¨ì–´ì¥ ìˆ¨ê¸°ê¸°";
    } else {
         document.getElementById("wordList").style.display = "none"; // ë‹¨ì–´ ì—†ìœ¼ë©´ ìˆ¨ê¹€
         document.getElementById("toggleBtn").innerText = "ë‹¨ì–´ì¥ ë³´ê¸°";
    }


  </script>
</body>
</html>
