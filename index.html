<!DOCTYPE html><html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>단어장</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #e0f7fa;
      color: #01579b;
      padding: 20px;
    }
    h1 {
      color: #0277bd;
    }
    input, button {
      margin: 5px;
      padding: 10px;
      border-radius: 5px;
      border: none;
    }
    input {
      border: 1px solid #0288d1;
    }
    button {
      background-color: #0288d1;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #0277bd;
    }
    .word-item {
      margin-bottom: 10px;
      padding: 10px;
      background-color: #ffffff;
      border-left: 4px solid #0288d1;
    }
    .correct {
      color: green;
    }
    .incorrect {
      color: red;
    }
    #testModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    #testBox {
      background: white;
      padding: 30px;
      border-radius: 10px;
      width: 90%;
      max-width: 600px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>영어 단어장</h1>
  <input type="text" id="wordInput" placeholder="단어" />
  <input type="text" id="meaningInput" placeholder="뜻 (쉼표로 구분)" />
  <button onclick="addWord()">단어 추가</button>
  <button onclick="resetWords()">초기화</button>
  <button onclick="prepareTest()">테스트</button>
  <label><input type="checkbox" id="excludeCorrect" /> 맞은 문제 제외</label>
  <button onclick="toggleWordList()" id="toggleBtn">단어장 보기/숨기기</button>  <div id="wordList"></div>
  <div id="testSection"></div>
  <div id="testModal" style="display:none">
    <div id="testBox">
      <h2 id="questionTitle"></h2>
      <p><strong id="testWord"></strong></p>
      <p>남은 시간: <span id="timer">20</span>초</p>
      <button onclick="showHint()">힌트</button><br>
      <input type="text" id="testAnswer" placeholder="뜻 입력" /><br>
      <button onclick="submitAnswer()">제출</button>
      <div id="testResult"></div>
    </div>
  </div>  <script>
    let words = JSON.parse(localStorage.getItem("words") || "[]");
    let currentTest = [], currentIndex = 0, testTimer, timeLeft = 20;

    function saveWords() {
      localStorage.setItem("words", JSON.stringify(words));
    }

    function addWord() {
      const word = document.getElementById("wordInput").value.trim();
      const meaning = document.getElementById("meaningInput").value.trim();
      if (word && meaning) {
        words.push({ word, meanings: meaning.split(',').map(m => m.trim()), correct: null });
        saveWords();
        displayWords();
        document.getElementById("wordInput").value = "";
        document.getElementById("meaningInput").value = "";
      }
    }

    function resetWords() {
      if (confirm("정말 초기화하시겠습니까?")) {
        words = [];
        saveWords();
        displayWords();
      }
    }

    function displayWords() {
      const list = document.getElementById("wordList");
      list.innerHTML = "<h2>단어 목록</h2>";
      words.forEach((item, index) => {
        const div = document.createElement("div");
        div.className = "word-item";
        div.innerHTML = `<strong>${item.word}</strong> - ${item.meanings.join(', ')} ` +
          (item.correct === true ? '<span class="correct">(정답)</span>' : item.correct === false ? '<span class="incorrect">(오답)</span>' : "");
        list.appendChild(div);
      });
    }

    function toggleWordList() {
      const list = document.getElementById("wordList");
      list.style.display = list.style.display === "none" ? "block" : "none";
    }

    function prepareTest() {
      const excludeCorrect = document.getElementById("excludeCorrect").checked;
      currentTest = words.filter(w => !excludeCorrect || w.correct !== true);
      currentTest = shuffle([...currentTest]);
      if (currentTest.length === 0) return alert("출제할 문제가 없습니다.");
      currentIndex = 0;
      document.getElementById("wordList").style.display = "none";
      document.getElementById("testModal").style.display = "flex";
      showQuestion();
    }

    function showQuestion() {
      clearInterval(testTimer);
      timeLeft = 20;
      document.getElementById("timer").innerText = timeLeft;
      const current = currentTest[currentIndex];
      document.getElementById("questionTitle").innerText = `문제 ${currentIndex + 1}`;
      document.getElementById("testWord").innerText = current.word;
      document.getElementById("testAnswer").value = "";
      document.getElementById("testResult").innerText = "";
      testTimer = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").innerText = timeLeft;
        if (timeLeft <= 0) submitAnswer();
      }, 1000);
    }

    function submitAnswer() {
      clearInterval(testTimer);
      const input = document.getElementById("testAnswer").value.trim();
      const correct = currentTest[currentIndex].meanings.includes(input);
      const result = document.getElementById("testResult");
      result.innerHTML = correct ? `<span class='correct'>정답! (${currentTest[currentIndex].meanings.join(', ')})</span>` :
        `<span class='incorrect'>오답. 정답: ${currentTest[currentIndex].meanings.join(', ')}</span>`;

      const original = words.find(w => w.word === currentTest[currentIndex].word);
      if (original) original.correct = correct;
      saveWords();

      setTimeout(() => {
        currentIndex++;
        if (currentIndex >= currentTest.length) {
          document.getElementById("testModal").style.display = "none";
          displayWords();
        } else {
          showQuestion();
        }
      }, 2000);
    }

    function showHint() {
      const word = currentTest[currentIndex].meanings[0];
      const hint = word[0] + ' -'.repeat(word.length - 1);
      alert(`힌트: ${hint}`);
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    displayWords();
  </script></body>
</html>
